function t(){return!function(){if("undefined"!=typeof window){const t=window.matchMedia("(prefers-reduced-motion: reduce)");return!t||t.matches}return!0}()}function e(t){return t.split(/[^\w]/).map(((t,e)=>0===e?t.toLowerCase():i(t))).join("")}function i(t){return t.replace(/^\w/,(t=>t.toUpperCase()))}class s{static supported=!0;direction="none";exit(){}async beforeEnter(){}async enter(){}complete(){}abort(){}finished=Promise.resolve()}class n{constructor(t){this.selector=t,this.ended=new Promise((t=>{this.resolve=t}))}async start(t){t();[...document.querySelectorAll(this.selector)].every((t=>t.getAnimations().length))?(await function(t){const e=[...document.querySelectorAll(t)];return Promise.all(e.map((t=>new Promise((e=>{t.addEventListener("animationend",(function i(){t.removeEventListener("animationend",i),e()}))})))))}(this.selector),this.resolve()):this.resolve()}}const r={animateRestore:!1};class a{constructor(t,e="none",i={}){this.action=t,this.direction=e,this.options={...r,...i},this.beforeExitClasses=new Set,this.exitClasses=new Set,this.enterClasses=new Set,this.beforeTransitionClasses=new Set,this.transitionClasses=new Set,this.forwardClasses=new Set,this.backClasses=new Set,this.noneClasses=new Set}addClasses(t){document.documentElement.classList.add(`turn-${t}`),Array.from(document.querySelectorAll(`[data-turn-${t}]`)).forEach((s=>{var n;s.dataset[`turn${n=t,n.split(/[^\w]/).map(i).join("")}`].split(/\s+/).forEach((i=>{i&&(s.classList.add(i),this[`${e(t)}Classes`].add(i))}))}))}removeClasses(t){document.documentElement.classList.remove(`turn-${t}`),Array.from(document.querySelectorAll(`[data-turn-${t}]`)).forEach((i=>{this[`${e(t)}Classes`].forEach((t=>i.classList.remove(t)))}))}dispatch(t,{target:e=document,detail:i={},bubbles:s=!0,cancelable:n=!0}={}){const r=`turn:${t}`,a=new window.CustomEvent(r,{detail:i,bubbles:s,cancelable:n});return e.dispatchEvent(a),a}}class o extends a{static supported=!0;exit(t){const e=new n("[data-turn-exit]");let i;this.animateOut=Promise.all([e.ended,new Promise((t=>{i=t}))]),this.addClasses("before-exit"),this.dispatch("before-exit",{detail:t}),window.requestAnimationFrame((()=>{e.start((()=>{this.addClasses(this.direction),this.addClasses("exit")})),this.removeClasses("before-exit"),i()}))}async beforeEnter(t){await this.animateOut,this.removeClasses("exit"),this.animateIn?await this.animateIn:this.dispatch("before-enter",{detail:{...t,action:this.action}})}enter(){const t=new n("[data-turn-enter]");return this.animateIn=t.ended,t.start((()=>this.addClasses("enter"))),this.animateIn}async complete(t){this.removeClasses("enter"),this.removeClasses(this.direction),this.dispatch("enter",{detail:{...t,action:this.action}})}abort(){this.removeClasses("before-exit"),this.removeClasses("exit"),this.removeClasses("enter"),this.removeClasses(this.direction)}get finished(){return this.animateIn}}class d extends a{static supported=!!document.startViewTransition;prepare(){return this.snapshot=new Promise((t=>{this.snapshat=t})),this.transition=document.startViewTransition((t=>this.render())),this.snapshot}exit(){}async beforeEnter(t){this.addClasses("before-transition"),this.dispatch("before-transition",{detail:{...t,action:this.action}}),await this.prepare()}render(){return this.snapshat(),new Promise((t=>{this.rendered=t}))}async enter(){this.rendered(),this.removeClasses("before-transition"),this.addClasses("transition"),await this.finished,await Promise.resolve(),this.removeClasses("transition")}complete(){}abort(){this.removeClasses("transition")}rendered(){}get finished(){return this.transition?.finished}}const c=["advance","restore","replace"];class h{constructor(t){this.config=t}start(){this.animationTurn=new s,this.viewTransitionTurn=new s,this.config,document.documentElement.classList.add(d.supported?"turn-view-transitions":"turn-no-view-transitions"),this.currentUrl=window.location.toString()}stop(){this.animationTurn.abort(),this.viewTransitionTurn.abort(),this.animationTurn=new s,this.viewTransitionTurn=new s,document.documentElement.classList.remove(d.supported?"turn-view-transitions":"turn-no-view-transitions"),delete this.initiator,delete this.currentUrl}click(t){this.initiator=t.target}submitStart(t){this.initiator=t.target}visit(t){this.reset(t),this.animationTurn=u(o,t.detail.action,t.detail.direction),this.viewTransitionTurn=u(d,t.detail.action,t.detail.direction),this.animationTurn.exit({...t.detail,referrer:this.currentUrl,initiator:this.initiator})}async beforeRender(t){t.preventDefault();const e={newBody:t.detail.newBody,referrer:this.currentUrl,initiator:this.initiator};await this.animationTurn.beforeEnter(e),this.hasPreview?await this.viewTransitionTurn.finished:await this.viewTransitionTurn.beforeEnter(e),this.isPreview&&(this.hasPreview=!0),t.detail.resume()}render(){this.currentUrl=window.location.toString(),delete this.initiator;(this.isPreview||!this.hasPreview)&&(this._render=this.viewTransitionTurn.enter().then((()=>this.animationTurn.enter())))}async load(t){await this._render,l(),this.animationTurn.complete({...t.detail,referrer:this.currentUrl})}popstate(t){"restore"!==this.animationTurn.action&&this.animationTurn.abort()}get isPreview(){return document.documentElement.hasAttribute("data-turbo-preview")}reset(t){var e;l(),e=t.detail.action,document.documentElement.classList.add(`turn-${e}`),this.hasPreview=void 0,this._render=void 0,this.animationTurn.abort(),this.viewTransitionTurn.abort(),"restore"!==t.detail.action&&this.initiator||(this.initiator=document.documentElement)}}function l(){const t=document.documentElement.classList;t.remove.apply(t,c.map((t=>`turn-${t}`)))}function u(t,e,i){t.supported&&"false"!==document.body.dataset.turn||(t=s);return new t(e,i,JSON.parse(document.body.dataset.turnOptions||"{}"))}const m={start(){if(!this.started&&t()){for(const t in w)window.addEventListener(t,w[t]);this.controller=new h(m.config),this.controller.start(),this.started=!0}},stop(){if(this.started){for(const t in w)window.removeEventListener(t,w[t]);this.controller.stop(),this.started=!1}},config:{experimental:{viewTransitions:!0}}},w={"turbo:click":function(t){this.controller.click(t)}.bind(m),"turbo:visit":function(t){this.controller.visit(t)}.bind(m),"turbo:submit-start":function(t){this.controller.submitStart(t)}.bind(m),"turbo:before-render":async function(t){this.controller.beforeRender(t)}.bind(m),"turbo:render":async function(){this.controller.render()}.bind(m),"turbo:load":async function(t){this.controller.load(t)}.bind(m),popstate:function(){this.controller.popstate()}.bind(m)};export{m as default};
